<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Test UI Tool - Option 1</title>
		<link rel="stylesheet" href="main.css">
	</head>
	<body>
    	<div id="main">
        	<div id="menu">
        		<div id="menuHead">
        			<div id="title">
	        			<p>Test Tool</p>
	        		</div>
	        		<div id="icon">
	        			<img title="Title" src="images/face-icon.png" height="20px" style="margin: 0;" />
	        		</div>
        		</div>
        		<div id="menuItems">
            		<p><a href="home.html">Home</a></p>
            		<p class="disabled">Option 1</p> 
            		<p><a href="option2.html">Option 2</a></p> 
            		<p><a href="option3.html">Option 3</a></p> 
            		<p><a href="option4.html">Option 4</a></p>
            		<hr />
            		<p><a href="login.html">Login</a></p>
            	</div>
       		</div>
        	<div id="content">
        		<div id="contentHead">
        			<div id="contentTitle">
        				<p>Option 1</p>
        			</div>
        			<div class="select">
        				<select name="env" id="env" onchange="updateEnv(this)">
        			        <option value="0">Local</option>
        					<option value="1">SIT</option>
        	        		<option value="2">OAT</option>
    		        		<option value="3">PROD</option>
        			    </select></p>
        			</div>
        		</div>
        		<div id="contentBody">
        			<div id="hostView" style="display: flex;">
        				<input value="GET" type="text" id="method" style="width: 3.5em;" disabled /><span style="margin-top: .25em; margin-right: .1em">:</span>
        				<select name="host" id="host" onchange="updateHost(this)" style="border-bottom: 1px solid #c0c0c0; border-right: 1px solid #c0c0c0; background-color: #ffffff;">
        					<option value="0">http://localhost:8080/customers</option>
        					<option value="1">http://localhost:8080/customers</option>
        					<option value="2">http://localhost:8080/customers</option>
        					<option value="3">http://localhost:8080/customers</option>
        					<option value="4">http://localhost:8080/customers</option>
        				</select>
        				<button class="info" type="button" style="padding-left: 2px; background-color: #ffffff;"><img id="info" title="Information" src="images/info-icon.png" height="20px" /></button>
        				<button type="button" style="padding-left: 2px;">Send</button>
        			</div>
        			<div>
						<details>
  							<summary>Request</summary>
  							<div id="request" class="tabset">
  								<!-- Tab 1 -->
  								<input type="radio" name="tabset" id="tab1" aria-controls="requestHeader" checked>
  								<label for="tab1">Headers</label>
  								<!-- Tab 2 -->
  								<input type="radio" name="tabset" id="tab2" aria-controls="requestParams">
  								<label for="tab2">Params</label>
  								<!-- Tab 3 -->
  								<input type="radio" name="tabset" id="tab3" aria-controls="requestBody">
  								<label for="tab3">Body</label>
  
  								<div class="tab-panels" style="height: *%">
  									<section id="requestHeader" class="tab-panel">
  									</section>
  									<section id="requestParams" class="tab-panel">
  									</section>
  									<section id="requestBody" class="tab-panel">
  									</section>
  								</div>
							</div>
						</details>
						<details>
  							<summary>Response</summary>
  							<div id="response" class="tabset">
  								<!-- Tab 1 -->
  								<input type="radio" name="tabset" id="tab1" aria-controls="responsetHeader" checked>
  								<label for="tab1">Headers</label>
  								<!-- Tab 2 -->
  								<input type="radio" name="tabset" id="tab2" aria-controls="responseParams">
  								<label for="tab2">Params</label>
  								<!-- Tab 3 -->
  								<input type="radio" name="tabset" id="tab3" aria-controls="responseBody">
  								<label for="tab3">Body</label>
  
  								<div class="tab-panels" style="height: *%">
  									<section id="responsetHeader" class="tab-panel">
  									</section>
  									<section id="responseParams" class="tab-panel">
  									</section>
  									<section id="responseBody" class="tab-panel">
  									</section>
  								</div>
							</div>
						</details>
           			</div>
           		</div>
        	</div>
    	</div>

		<script>
			const current = JSON.parse('{' 
					+ '"env": 0, "func": 0'
				+ '}');
			const envs = JSON.parse('[{' 
					+ '"env": "Local", "route": "localhost:8080"'
				+ '}, {'
					+ '"env": "SIT", "route": "sit.bocaditos.co.uk"'
				+ '}, {'
					+ '"env": "OAT", "route": "oat-bocaditos.co.uk"'
				+ '}, {'
					+ '"env": "OAT", "route": "bocaditos.co.uk"'
				+ '}]');
			const funcs = JSON.parse('[{' 
					+ '"func": "customers", "method": "GET",    "info": "Gets the customer.",    "headers": [], "params": [], "body": []' 
				+ '}, {'
					+ '"func": "customers", "method": "POST",   "info": "Creates the customer.", "headers": [], "params": [], "body": []'
				+ '}, {'
					+ '"func": "customers", "method": "PUT",    "info": "Updates the customer.", "headers": [], "params": [], "body": []'
				+ '}, {'
					+ '"func": "customers", "method": "PATCH",  "info": "Changes the customer.", "headers": [], "params": [], "body": []'
				+ '}, {'
					+ '"func": "customers", "method": "DELETE", "info": "Deletes the customer.", "headers": [], "params": [], "body": []'
				+ '}]');


			function updateEnv(env) {
				const index = env.value;

				if (index != current.env) {
					console.log("Updating environment by event with index " + index + "...");

					current.env = index;
					env.value = envs[index].route;

					const hosts = document.getElementById('host');

					current.func = 0;
					while (hosts.length > 0) {
						hosts.remove(0);
					}
					for (var i = 0; i < funcs.length; i++) {
						var opt = document.createElement('option');

					    opt.value = i;
					    opt.innerHTML = envs[current.env].route + "/" + funcs[current.func].func;
					    hosts.appendChild(opt);
					}
					hosts.options[0].selected = 'selected';
					updateHost(host);

					console.log("Environment updated by event with index " + index);
				}
			}

			function updateHost(el) {
				const index = el.value;

				if (index != current.func) {
					console.log("Updating host by event with index " + index + "...");

					const method = document.getElementById('method');

					current.func = index;
//					host.value = envs[current.env].route + "/" + funcs[current.func];
					method.value = funcs[index].method;
					document.getElementById('info').title=funcs[index].info;

					console.log("Host updated by event with index " + index);
				}
			}
		</script>
	</body>
</html>